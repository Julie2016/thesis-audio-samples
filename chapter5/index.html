<html>
  <head>
    <meta charset="UTF-8">
    <title>Pre-Alignment Guided Attention for Improving Training Efficiency and Model Stability in End-to-End Speech Synthesis</title>
    <link rel="stylesheet" type="text/css" href="../../stylesheet.css"/>
  </head>
  <body>
    <article>
      <header>
        <h1>Samples from "Pre-Alignment Guided Attention for Improving Training Efficiency and Model Stability in End-to-End Speech Synthesis"</h1>
      </header>
    </article>

    <!-- <div><b>Paper:</b> <a href="https://www.baidu.com">arXiv</a> <a href="http://www.baidu.com">ICASSP 2019</a></div> -->
    <div><b>Authors:</b> Xiaolian Zhu, Yuchao Zhang, Shan Yang, Liumeng Xue, Lei Xie</div>
    <div><b>Abstract:</b> Recently, end-to-end (E2E) neural text-to-speech systems, such as Tacotron2, have begun to surpass the traditional multi-stage hand-engineered systems, with both simplified system building pipelines and high quality speech. With a unique encoder-decoder neural structure, the Tacotron2 system no longer needs
separately learned text analysis front-end, duration model, acoustic model and audio synthesis module. The key of such system lies in the attention mechanism, which learns an alignment between the encoder and the decoder, serving as an implicit duration model bridging the text sequence and the acoustic sequence. However, attention learning suffers from low training efficiency and model instability problems, which hinder the E2E approaches from wide deployment. In this paper, we address the problems and propose a novel pre-alignment guided attention learning approach. Specifically, we inject handy prior knowledge – accurate phoneme durations – in the neural network loss function to bias the attention learning to the desired direction more accurately. The explicit time alignment between an audio recording and its corresponding phoneme sequence can be achieved by forced-alignment from an automatic speech recognizer (ASR). Experiments show that the proposed pre-alignment guided (PAG) attention approach can significantly improve training efficiency and model stability. More specifically, the PAG updated version of Tacotron2 can quickly obtain the attention alignment using only 500 htext, audioi pairs, which is apparently not possible for the original Tacotron2. A series of subjective experiments also show that the PAG-Tacotron2 approach
can synthesize more stable and natural speech.</div>
	
	<div><p></p><font size="3" color="red">Note: These samples are synthesized from Mel-spectrum by Griffin-Lim algorithm. We just need to pay attention to prosody because this work has no relation with sound quality basically. </font></div>

    <div>
      <h3>Data size of 0.5 hours (Left: Tacotron2, Mid: DIG-Tactoron2, Right: PAG-Tacotron2)<p></p></h3>
      <table>
        <tr><td class="transcript">“我对面这个手端一杆旱烟袋的瘦小老头儿。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/E_T0.5_0.wav"></audio><audio controls><source src="audios_samples/diagonal/E_T0.5_0.wav"></audio><audio controls><source src="audios_samples/guided/E_T0.5_0.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“围住了一头三十多吨重的长须鲸。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/E_T0.5_4.wav"></audio><audio controls><source src="audios_samples/diagonal/E_T0.5_4.wav"></audio><audio controls><source src="audios_samples/guided/E_T0.5_4.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“企图将船掀翻，乘机从子羽手里夺璧。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/E_T0.5_17.wav"></audio><audio controls><source src="audios_samples/diagonal/E_T0.5_17.wav"></audio><audio controls><source src="audios_samples/guided/E_T0.5_17.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“那可是一张青年文艺创作的优等奖状。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/E_T0.5_14.wav"></audio><audio controls><source src="audios_samples/diagonal/E_T0.5_14.wav"></audio><audio controls><source src="audios_samples/guided/E_T0.5_14.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“大象还是不愿松开鼻卷。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/E_T0.5_29.wav"></audio><audio controls><source src="audios_samples/diagonal/E_T0.5_29.wav"></audio><audio controls><source src="audios_samples/guided/E_T0.5_29.wav"></audio><p></p></td></tr>
      </table>
    </div>

    <div>
      <h3>Data size of 1 hours (Left: Tacotron2, Mid: DIG-Tactoron2, Right: PAG-Tacotron2)<p></p></h3>
      <table>
        <tr><td class="transcript">“我对面这个手端一杆旱烟袋的瘦小老头儿。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/D_T1_0.wav"></audio><audio controls><source src="audios_samples/diagonal/D_T1_0.wav"></audio><audio controls><source src="audios_samples/guided/D_T1_0.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“围住了一头三十多吨重的长须鲸。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/D_T1_4.wav"></audio><audio controls><source src="audios_samples/diagonal/D_T1_4.wav"></audio><audio controls><source src="audios_samples/guided/D_T1_4.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“企图将船掀翻，乘机从子羽手里夺璧。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/D_T1_17.wav"></audio><audio controls><source src="audios_samples/diagonal/D_T1_17.wav"></audio><audio controls><source src="audios_samples/guided/D_T1_17.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“那可是一张青年文艺创作的优等奖状。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/D_T1_14.wav"></audio><audio controls><source src="audios_samples/diagonal/D_T1_14.wav"></audio><audio controls><source src="audios_samples/guided/D_T1_14.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“大象还是不愿松开鼻卷。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/D_T1_29.wav"></audio><audio controls><source src="audios_samples/diagonal/D_T1_29.wav"></audio><audio controls><source src="audios_samples/guided/D_T1_29.wav"></audio><p></p></td></tr>
      </table>
    </div>

   <div>
      <h3>Data size of 3 hours (Left: Tacotron2, Mid: DIG-Tactoron2, Right: PAG-Tacotron2)<p></p></h3>
      <table>
        <tr><td class="transcript">“我对面这个手端一杆旱烟袋的瘦小老头儿。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/C_T3_0.wav"></audio><audio controls><source src="audios_samples/diagonal/C_T3_0.wav"></audio><audio controls><source src="audios_samples/guided/C_T3_0.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“围住了一头三十多吨重的长须鲸。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/C_T3_4.wav"></audio><audio controls><source src="audios_samples/diagonal/C_T3_4.wav"></audio><audio controls><source src="audios_samples/guided/C_T3_4.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“企图将船掀翻，乘机从子羽手里夺璧。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/C_T3_17.wav"></audio><audio controls><source src="audios_samples/diagonal/C_T3_17.wav"></audio><audio controls><source src="audios_samples/guided/C_T3_17.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“那可是一张青年文艺创作的优等奖状。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/C_T3_14.wav"></audio><audio controls><source src="audios_samples/diagonal/C_T3_14.wav"></audio><audio controls><source src="audios_samples/guided/C_T3_14.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“大象还是不愿松开鼻卷。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/C_T3_29.wav"></audio><audio controls><source src="audios_samples/diagonal/C_T3_29.wav"></audio><audio controls><source src="audios_samples/guided/C_T3_29.wav"></audio><p></p></td></tr>
      </table>
    </div>

   <div>
      <h3>Data size of 5 hours (Left: Tacotron2, Mid: DIG-Tactoron2, Right: PAG-Tacotron2)<p></p></h3>
      <table>
        <tr><td class="transcript">“我对面这个手端一杆旱烟袋的瘦小老头儿。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/B_T5_0.wav"></audio><audio controls><source src="audios_samples/diagonal/B_T5_0.wav"></audio><audio controls><source src="audios_samples/guided/B_T5_0.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“围住了一头三十多吨重的长须鲸。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/B_T5_4.wav"></audio><audio controls><source src="audios_samples/diagonal/B_T5_4.wav"></audio><audio controls><source src="audios_samples/guided/B_T5_4.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“企图将船掀翻，乘机从子羽手里夺璧。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/B_T5_17.wav"></audio><audio controls><source src="audios_samples/diagonal/B_T5_17.wav"></audio><audio controls><source src="audios_samples/guided/B_T5_17.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“那可是一张青年文艺创作的优等奖状。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/B_T5_14.wav"></audio><audio controls><source src="audios_samples/diagonal/B_T5_14.wav"></audio><audio controls><source src="audios_samples/guided/B_T5_14.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“大象还是不愿松开鼻卷。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/B_T5_29.wav"></audio><audio controls><source src="audios_samples/diagonal/B_T5_29.wav"></audio><audio controls><source src="audios_samples/guided/B_T5_29.wav"></audio><p></p></td></tr>
      </table>
    </div>

   <div>
      <h3>Data size of 10 hours (Left: Tacotron2, Mid: DIG-Tactoron2, Right: PAG-Tacotron2)<p></p></h3>
      <table>
        <tr><td class="transcript">“我对面这个手端一杆旱烟袋的瘦小老头儿。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/A_T10_0.wav"></audio><audio controls><source src="audios_samples/diagonal/A_T10_0.wav"></audio><audio controls><source src="audios_samples/guided/A_T10_0.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“围住了一头三十多吨重的长须鲸。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/A_T10_4.wav"></audio><audio controls><source src="audios_samples/diagonal/A_T10_4.wav"></audio><audio controls><source src="audios_samples/guided/A_T10_4.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“企图将船掀翻，乘机从子羽手里夺璧。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/A_T10_17.wav"></audio><audio controls><source src="audios_samples/diagonal/A_T10_17.wav"></audio><audio controls><source src="audios_samples/guided/A_T10_17.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“那可是一张青年文艺创作的优等奖状。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/A_T10_14.wav"></audio><audio controls><source src="audios_samples/diagonal/A_T10_14.wav"></audio><audio controls><source src="audios_samples/guided/A_T10_14.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“大象还是不愿松开鼻卷。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/soft/A_T10_29.wav"></audio><audio controls><source src="audios_samples/diagonal/A_T10_29.wav"></audio><audio controls><source src="audios_samples/guided/A_T10_29.wav"></audio><p></p></td></tr>
      </table>
    </div>

      <div>
      <h3>Synthesized long utterance (Left: Tacotron2, Mid: DIG-Tactoron2, Right: PAG-Tacotron2)<p></p></h3>
      <table>
        <tr><td class="transcript">“《悲惨世界》是由法国作家维克多·雨果在1862年发表的一部长篇小说，其内容涵盖了拿破仑战争和之后的十几年的时间。
故事的主线围绕主人公土伦苦刑犯冉·阿让的个人经历，融进了法国的历史、革命、战争、道德哲学、法律、正义、宗教信仰。该作多次被改编演绎成影视作品。主人公冉·阿让原是个诚实的工人，一直帮助穷困的姐姐抚养七个可怜的孩子。有一年冬天，他找不到工作，为了不让孩子饿死，他只得去偷了一块面包，因此被判处五年。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/long_para/soft.wav"></audio><audio controls><source src="audios_samples/long_para/diagonal.wav"></audio><audio controls><source src="audios_samples/long_para/guided.wav"></audio><p></p></td></tr>
      </table>
      </div>


   <div>
      <h3>Analysis of prosody(Left: Tacotron2, Mid: DIG-Tactoron2, Right: PAG-Tacotron2)<p></p></h3>
      <table>
        <tr><td class="transcript">“成千上万只燕子，从南方飞回北方时。”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/prosody/soft.wav"></audio><audio controls><source src="audios_samples/prosody/diagonal.wav"></audio><audio controls><source src="audios_samples/prosody/guided.wav"></audio><p></p></td></tr>
      </table>
    </div>

    <div>
      <h3>Synthesized speech of number (Left: Tacotron2, Mid: DIG-Tactoron2, Right: PAG-Tacotron2)<p></p></h3>
      <table>
        <tr><td class="transcript">“6666666666”<p></p></td></tr>
        <tr><td><audio controls><source src="audios_samples/number/soft.wav"></audio><audio controls><source src="audios_samples/number/diagonal.wav"></audio><audio controls><source src="audios_samples/number/guided.wav"></audio><p></p></td></tr>
      </table>
    </div>

    <hr /> 

    <div>
      <h3> PAG-Transformer VS Transformer<p></p></h3>
      <h3> Normal samples  (Left: Transformer, Right: PAG-Transformer)</h3>
      <table>
        <tr><td class="transcript">“我对面这个手端一杆旱烟袋的瘦小老头儿。”<p></p></td></tr>
        <tr><td><audio controls><source src="transformer/multihead/eval-500000-0.wav"></audio><audio controls><source src="transformer/pag/eval-500000-0.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“围住了一头三十多吨重的长须鲸。”<p></p></td></tr>
        <tr><td><audio controls><source src="transformer/multihead/eval-500000-14.wav"></audio></audio><audio controls><source src="transformer/pag/eval-500000-14.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“企图将船掀翻，乘机从子羽手里夺璧。”<p></p></td></tr>
        <tr><td><audio controls><source src="transformer/multihead/eval-500000-4.wav"></audio><audio controls><source src="transformer/pag/eval-500000-4.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“那可是一张青年文艺创作的优等奖状。”<p></p></td></tr>
        <tr><td><audio controls><source src="transformer/multihead/eval-500000-17.wav"></audio><audio controls><source src="transformer/pag/eval-500000-17.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">“大象还是不愿松开鼻卷。”<p></p></td></tr>
        <tr><td><audio controls><source src="transformer/multihead/eval-500000-29.wav"></audio><audio controls><source src="transformer/pag/eval-500000-29.wav"></audio><p></p></td></tr>
      </table>
    </div>    

    <div>
      <h3> Wrong samples  (Left: Transformer, Right: PAG-Transformer) </h3>
      <table>
        <tr><td class="transcript">1. Mispronunciation “把灌木统统砍光，把杂草统统除。”<p></p></td></tr>
        <tr><td><audio controls><source src="transformer/problem/transformer/eval-500000-6.wav"></audio><audio controls><source src="transformer/problem/pag/eval-500000-6.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">2. Skip “醋也有了辛辣味，色味双美。”<p></p></td></tr>
        <tr><td><audio controls><source src="transformer/problem/transformer/eval-500000-11.wav"></audio></audio><audio controls><source src="transformer/problem/pag/eval-500000-11.wav"></audio><p></p></td></tr>
      </table>
      <table>
        <tr><td class="transcript">3. Repeat “只要求他像玩游戏一样去尝试一下。”<p></p></td></tr>
        <tr><td><audio controls><source src="transformer/problem/transformer/eval-500000-12.wav"></audio><audio controls><source src="transformer/problem/pag/eval-500000-12.wav"></audio><p></p></td></tr>
      </table>
    </div>  

  </body>
</html>